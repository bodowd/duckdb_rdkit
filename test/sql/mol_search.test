# Require statement will ensure this test is run with this extension loaded
require duckdb_rdkit


# setup
statement ok
CREATE TABLE molecules (m Mol);
INSERT INTO molecules VALUES ('c1ccccc1'), ('CCO'), ('c1ccncc1'), ('c1ccc(-c2ccccn2)nc1'), ('CCO')

# find exact match even if smiles is not canonical
query I
SELECT m FROM molecules WHERE m='C1=CC=CC=C1';
----
c1ccccc1

# returns no rows if no match
query I
SELECT m FROM molecules WHERE m='CCCCCCCCC';
----

# returns multiple matches
query I
SELECT m FROM molecules WHERE m='CCO';
----
CCO
CCO

# check that exact_match works while a simple '=' operator fails to 
# find the same molecule
statement ok
INSERT INTO molecules VALUES ('Cc1ccccc1');

# '=' operator fails to find the same molecule 
query I
SELECT m from molecules WHERE m='c1ccccc1C';
----

# exact_match function successfully finds the molecule
# and returns it in the same SMILES format it was entered as
query I
SELECT m from molecules WHERE exact_match(m,'c1ccccc1C');
----
Cc1ccccc1

